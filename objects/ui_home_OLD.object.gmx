<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sprite39</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>3</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///prepare
state=n0;
stime=n0;
dy=n0;
menu=n0; //chara, craft, items, tools
page=n0;
title="";
select=-n1;
select_worker=-n1; //this will be used for communicating with ui_worker
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///script
//anim
if(state==0){
    if(stime&lt;45){stime++;}//anim_in
    //click
    else if(mouse_check_button_released(mb_left)){ if(!instance_exists(ui_craft) &amp;&amp; !instance_exists(ui_worker) &amp;&amp; !instance_exists(ui_dialog)){{
        //close
        if(mouse_y&gt;=1080){state=n1;func_sound_click();}
        //menu choose
        else if(mouse_y&gt;=920){func_sound_click();
            var menuChosen=floor((mouse_x-40)/160);
            page=n0;
            select=-n1;
            //lock option if we are in some state
            if(select_worker&gt;-n1){menu=n3;}//select tool for worker
            else if(instance_exists(ui_team)){menu=n0;}//select worker for team
            else{menu=clamp(menuChosen,0,3);}
        }
        
        //aux buttons
        else if(mouse_x&gt;=520-60&amp;&amp;mouse_y&gt;=760-60&amp;&amp;mouse_x&lt;=520+60&amp;&amp;mouse_y&lt;=760+60){
            var pos = (n9*page)+select;
            //item sell
            if(menu == n2){if(func_item_sell_price(pos)&gt;n0){func_sound_click();
                func_item_sell(pos);
            }}
            //tool upgrade
            else if(menu==n3){func_sound_click();
                func_tool_upgrade(pos);//selected
            }
        }
        //item choose
        else if(mouse_x&gt;=80&amp;&amp;mouse_y&gt;=80&amp;&amp;mouse_x&lt;=640&amp;&amp;mouse_y&lt;=640){
            //row3
            if(mouse_y&gt;=480){select=n6;}
            //row2
            else if(mouse_y&gt;=280){select=n3;}
            //row1
            else{select=n0;}
            //col
            select=select+floor((mouse_x-80)/200);
            //action
            var selected=(n9*page)+select;
            switch(menu){
                case 0: //worker
                    if(selected&gt;ds_list_size(global.work)-n1){
                        //out or range
                        select=-n1;
                    }
                    else{func_sound_click();
                        //select_worker_for_team
                        if(instance_exists(ui_team)){
                            var result=func_team_set_worker(global.map_team,team.select,selected);
                            //fail
                            if(result==n0){
                                var de = instance_create(0,0,ui_dialog_alert);
                                de.text=global.txt_team_conflict;
                                de.buttontext=global.txt_ok;
                            }
                            state=n1;//close this
                        }
                        //open worker menu
                        else {
                            var workerMenu=instance_create(0,0,ui_worker); workerMenu.parent=id;
                            workerMenu.worker=selected;
                            with(workerMenu) {event_perform(ev_other,ev_user0);}
                            select=-n1;
                        }
                    }
                    break;
                case 2://items
                    if(selected&gt;ds_list_size(global.item)-n1){
                        //out or range
                        select=-n1;
                    }
                    //choose item (in-game)
                    else {func_sound_click();
                        if(room==room_game){
                            global.current_item = selected;
                            state=n1;
                        }
                    }
                    break;
                case 3: //tools
                    if(selected&gt;ds_list_size(global.tool)-n1){
                        //out of range
                        select=-n1;
                    }
                    //select_tool_for_worker
                    else {func_sound_click();
                        if(select_worker&gt;-n1){
                            func_tool_set_owner(selected,select_worker);
                            //summon_worker_menu_again
                            var workerMenu=instance_create(0,0,ui_worker); workerMenu.parent=id;
                            workerMenu.worker=select_worker;
                            with(workerMenu) {event_perform(ev_other,ev_user0);}
                            select_worker=-n1;
                            select=-n1;
                            menu=n0;
                        }
                    }
                    break;
                case 1: //craft
                    if(func_craft_exists(page,select)==n1){func_sound_click();//unique behavior, does not use "selected" variable
                        var craftDialog = instance_create(0,0,ui_craft);
                        craftDialog.page = page;
                        craftDialog.select = select;
                        //setup
                        with(craftDialog){event_perform(ev_other,ev_user0);}
                    }
                    //reset
                    select=-n1;
                    break;
            }
        }
        //page_buttons
        else if((mouse_y&gt;=280&amp;&amp;mouse_x&lt;=80&amp;&amp;mouse_y&lt;=480) || (mouse_x&gt;=640&amp;&amp;mouse_y&gt;=280&amp;&amp;mouse_y&lt;=440)){func_sound_click();
            var i=clamp(mouse_x/360,n0,n1);//get input
            var n9p=n9*(page+n1);
            if(i==n1){//forward
                switch(menu){
                    case 0: if(n9p&lt;ds_list_size(global.work)){page++;} break;//worker
                    case 1: page++; break;//crafting
                    case 2: if(n9p&lt;ds_list_size(global.item)){page++;} break;//item
                    case 3: if(n9p&lt;ds_list_size(global.tool)){page++;} break;//tool
                }
            }
            else if(page&gt;n0){page--;}//back
            //reset some vars
            select=-n1;
        }
    }}}
    
}
else{
    if(stime&gt;0){stime--;}//anim_out
    else{
        game_save_data();
        instance_destroy();
    }
}
title="";//reset title
dy = func_dy(stime,45);
//limit options if we are in game
if(room==room_game){menu=clamp(menu,1,2);}
//draw_dim
draw_dim(stime,45);
//draw_bottom
draw_sprite_ext(spr_home,2,0,dy,1,1,0,c_ltgray,1);
//draw_selection
if(stime&gt;=45){if(select&gt;-1){
    var sx=func_home_grid(0,select);
    var sy=func_home_grid(1,select);
    draw_sprite_ext(spr_flash,0,sx,sy,1,1,0,c_yellow,1)
}}
//draw_grid
switch(menu){
    case 0://worker
        var i=0; repeat(9){
            var pos = 9*page+i;
            if(ds_list_size(global.work)&gt;pos){//exists?
                //get data
                var iid = ds_map_find_value(global.work[|pos],ID);
                var iskn= ds_map_find_value(global.work[|pos],SKN);
                //position
                var ix=func_home_grid(0,i);
                var iy=func_home_grid(1,i);
                //draw
                draw_sprite_ext(spr_worker_icon,iid,ix,dy+iy,4/3,4/3,0,c_white,1);
                //draw_rarity
                draw_sprite_ext(spr_star, global.worker_star[|iid]-1, ix,dy+iy+40, 1,1,0,c_white,1);
        }
        i++;}
        break;
    case 2://items
        var i=0; repeat(9){
            var pos = 9*page+i;
            if(ds_list_size(global.item)&gt;pos){//exists?
                //position
                var ix=func_home_grid(0,i);
                var iy=func_home_grid(1,i);
                //draw
                draw_sprite_ext(spr_item,pos,ix,dy+iy,4/3,4/3,0,c_white,1);
                //amount
                draw_shadowed_text(ix+40,dy+iy+40,global.item[|pos],global.font,fa_middle,fa_center,c_white);
            }
        i++;}
        break;
    case 3://tools
        if(select_worker&gt;-1){title=global.txt_select_tool;}//draw title (if we are choosing a tool for a worker)
        var i=0; repeat(9){
            var pos = 9*page+i;
            if(ds_list_size(global.tool)&gt;pos){//exists?
                var iid=ds_map_find_value(global.tool[|pos],ID);
                var itxt = "LV "+string(ds_map_find_value(global.tool[|pos],LV))+RETURN+"SLV "+string(ds_map_find_value(global.tool[|pos],SLV));
                //position
                var ix=func_home_grid(0,i);
                var iy=func_home_grid(1,i);
                //draw
                draw_sprite_ext(spr_tool,iid,ix,dy+iy,4/3,4/3,0,c_white,1);
                //amount
                draw_shadowed_text(ix,dy+iy,itxt,global.font,fa_middle,fa_center,c_white);
            }
        i++;}
        break
    case 1://craft
        page=clamp(page,0,1);//pages
        title=global.txt_craft_page [page];
        var col = c_white; //color for icons
        var cspr= spr_item;
        var i = n0; repeat(n9){
            if(func_craft_exists(page,i)==n1){
                var cr = global.craft_requirement[#page,i];
                if(func_craft_requirements(page,i,n1)==n0){col=c_red;}else{col=c_white;}
                if(cr[#n9,n0]==n0){cspr=spr_item;}else{cspr=spr_tool;}
                draw_sprite_ext(cspr,cr[#n9,n1],func_home_grid(0,i),dy+func_home_grid(1,i),4/3,4/3,0,col,1);//wood wall
            }
        i++;}
        break
}
//draw_center
draw_sprite_ext(spr_home,0,0,dy,1,1,0,c_white,1);
//draw_details
if(select&gt;-1){
    var pos = 9*page+select;
    switch(menu){
        case 2://items
            draw_sharp_text(120,dy+680,global.txt_item_name[pos],global.font,fa_left,fa_top,c_black);
            //sell
            var itemSellPrice = func_item_sell_price(pos);
            if(itemSellPrice&gt;0){
                draw_sharp_text_ext(520,dy+660,global.txt_item_sell,global.font,fa_middle,fa_center,c_black,0,720,0.65,0.65,0);//title
                draw_sprite(spr_120_120_button,0,520,dy+760);
                draw_sprite(spr_item,n6,520,dy+760);
                draw_sharp_text(520,dy+880, string(itemSellPrice) ,global.font,fa_middle,fa_bottom,c_black);
            }
            break;
        case 3://tools
            //details
            var tid = ds_map_find_value(global.tool[|pos],ID);
            var tlv = ds_map_find_value(global.tool[|pos],LV);
            var treq= func_tool_upgrade_requirements(tid);
            var ti = "0"; if(treq&lt;ds_list_size(global.item)){ti=string(global.item[|treq]);}
            //status
            draw_sharp_text(120,dy+680,global.tool_name[tid]+RETURN+"LV "+string(tlv)+RETURN+"SLV "+string(ds_map_find_value(global.tool[|pos],SLV)),global.font,fa_left,fa_top,c_black);
            //lv_up
            draw_sharp_text_ext(520,dy+660,global.txt_tool_up,global.font,fa_middle,fa_center,c_black,0,720,0.65,0.65,0);//title
            draw_sprite(spr_120_120_button,0,520,dy+760);
            draw_sprite(spr_item,treq,520,dy+760);//item required
            draw_sharp_text(520,dy+880,ti+"-"+string(tlv),global.font,fa_middle,fa_bottom,c_black);//amount required
            //+100 = right &amp; fa_right
            break;
    }
}
//draw title
draw_sharp_text(360,dy+640,title,global.font,fa_middle,fa_top,c_black);
//draw_label
var layout=1;
var hcol=c_black
if(room==room_game){
    hcol=c_ltgray
    layout=3;
}
draw_sharp_text_ext(120,dy+1050,global.txt_worker,global.font,fa_middle,fa_center,hcol,0,160,0.8,0.8,0);
draw_sharp_text_ext(600,dy+1050,global.txt_tool,global.font,fa_middle,fa_center,hcol,0,160,0.8,0.8,0);
draw_sharp_text_ext(280,dy+1050,global.txt_craft,global.font,fa_middle,fa_center,c_black,0,160,0.8,0.8,0);
draw_sharp_text_ext(440,dy+1050,global.txt_item,global.font,fa_middle,fa_center,c_black,0,160,0.8,0.8,0);
//draw light
draw_sprite_ext(spr_flash,0,120+(menu*160),dy+980,1,1,0,c_yellow,1);
//draw_top
draw_sprite_ext(spr_home,layout,0,dy,1,1,0,c_white,1);
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
